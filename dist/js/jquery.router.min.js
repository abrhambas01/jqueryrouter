!function(t,e,n){function a(t){return Array.prototype.slice.call(t)}function r(){g.noTrigger?g.noTrigger=!1:e.router.events.trigger(v.routeChanged,{data:g.data})}function o(t){throw new Error(t)}function i(t){return"string"==typeof t&&m.pathname.test(t)}function u(t){if(i(t))return t;o(y.invalidPath)}function h(a,r,o){var i=null,h=null,s="",c=r?"replaceState":"pushState";g.noTrigger=o,"object"==typeof a?(g.data=i=a.data,h=a.title,s=a.route):"string"==typeof a&&(s=a),f?(n[c]({data:i},h,u(s)),o||e.router.events.trigger(v.routeChanged,{data:g.data})):r?t.location.replace("#"+s):t.location.hash=u(s)}function s(t,e){d.handlers.push({eventName:v.routeChanged,handler:e.bind(this),element:this,route:t})}function c(t){return t.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,"")}function l(t,e,n){if(!m.routeparams.test(t))return t===e;var r=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(r.test(e)){var o=a(t.match(m.routeparams)).map(c),i=a(e.match(r));return i.shift(),o.forEach(function(t,e){n.params[t]=i[e]}),!0}return!1}function p(n,a){a=e.extend(a,{}),d.handlers.forEach(function(e){e.eventName===n&&(f&&l(e.route,t.location.pathname,a)?e.handler(a.data,a.params):!t.location.hash&&l(e.route,t.location.pathname,a)?(g.data=a.data,t.location.replace("#"+t.location.pathname)):l(e.route,t.location.hash.substring(1),a)&&e.handler(a.data,a.params))})}if(e&&e.fn){var d={handlers:[]},f=n&&n.pushState,g={noTrigger:!1},m={pathname:/^\/(?=[^?]+)/,routeparams:/:[^\/]+/g},v={routeChanged:"routeChanged"},y={invalidPath:"Path is invalid"};if(e.router||(e.router={events:v,init:function(){e.router.events.trigger(v.routeChanged)},historySupported:f},e.router.events.trigger=function(t,e){p.apply(this,[t,e])}),!e.fn.route){var w=e.fn.route=function(t,e){s.apply(this,[t,e])};e.route||(e.route=w.bind(null))}e.setRoute||(e.setRoute=function(t,e,n){h.apply(this,[t,e,n])}),d.init=function(){f?e(t).on("popstate",r):e(t).on("hashchange",r)},d.init()}}(window,window.jQuery,window.history);