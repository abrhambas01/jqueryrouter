!function(t,e,n){function a(t){return Array.prototype.slice.call(t)}function r(){m.noTrigger?m.noTrigger=!1:e.router.events.trigger(y.routeChanged,{data:m.data})}function o(t){throw new Error(t)}function i(t){return"string"==typeof t&&v.pathname.test(t)}function u(e,n,a){return n||a?"string"==typeof n?(n=n.trim())&&a?e+t.location.search+"&"+n.replace("?",""):n?e+"?"+n.replace("?",""):e:void 0:e}function h(t,e,n){if(i(t))return u(t,e,n);o(w.invalidPath)}function c(a,r,o){var i=null,u=null,c="",s="",p=!1,l=r?"replaceState":"pushState";m.noTrigger=o,"object"==typeof a?(m.data=i=a.data,u=a.title,c=a.route,s=a.queryString,p=a.appendQuery):"string"==typeof a&&(c=a),g?(n[l]({data:i},u,h(c,s,p)),o||e.router.events.trigger(y.routeChanged,{data:m.data})):r?t.location.replace("#"+h(c,s,p)):t.location.hash=h(c,s,p)}function s(t,e){f.handlers.push({eventName:y.routeChanged,handler:e.bind(this),element:this,route:t})}function p(t){return t.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,"")}function l(t,e,n){if(!v.routeparams.test(t))return t===e;var r=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(r.test(e)){var o=a(t.match(v.routeparams)).map(p),i=a(e.match(r));return i.shift(),o.forEach(function(t,e){n.params[t]=i[e]}),!0}return!1}function d(n,a){a=e.extend(a,{}),f.handlers.forEach(function(e){e.eventName===n&&(g&&l(e.route,t.location.pathname,a)?e.handler(a.data,a.params):!t.location.hash&&l(e.route,t.location.pathname,a)?(m.data=a.data,t.location.replace("#"+t.location.pathname)):l(e.route,t.location.hash.substring(1),a)&&e.handler(a.data,a.params))})}if(e&&e.fn){var f={handlers:[]},g=n&&n.pushState,m={noTrigger:!1},v={pathname:/^\/(?=[^?]+)/,routeparams:/:[^\/]+/g},y={routeChanged:"routeChanged"},w={invalidPath:"Path is invalid"};if(e.router||(e.router={events:y,init:function(){e.router.events.trigger(y.routeChanged)},historySupported:g},e.router.events.trigger=function(t,e){d.apply(this,[t,e])}),!e.fn.route){var C=e.fn.route=function(t,e){s.apply(this,[t,e])};e.route||(e.route=C.bind(null))}e.setRoute||(e.setRoute=function(t,e,n){c.apply(this,[t,e,n])}),f.init=function(){g?e(t).on("popstate",r):e(t).on("hashchange",r)},f.init()}}(window,window.jQuery,window.history);