!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.deparam={})}(this,function(t){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(a){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},e=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(t){var e,n,r;e=a,r=o[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r})}return a}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,n=(function(t,e){t.exports=function(){function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a="undefined"!=typeof window,t=void 0!==c,i=Array.isArray;function o(t){return t=(t+"").trim(),!(-1<["null","undefined",""].indexOf(t)||isNaN(Number(t)))}function y(t){return/\[/.test(t)}function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:a?window.location.search:"",e=(t=decodeURIComponent(t).replace("?","").trim()).split("&"),n={};return t&&e.forEach(function(t){var e=t.split("=");y.apply(void 0,r(e))?function t(e,n,r){var a,o,i,u=e.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===u.length){var c=d(u,3),l=c[1],f=c[2];if(y(e=e.replace(/\[([^\[]*)\]/,"")))""===f&&(f="0"),e=e.replace(/[^\[]+/,f),t(e,n,r[l]=w(r[l],f).ob);else if(f){var s=w(r[l],f),h=s.ob,p=s.push;r[l]=h,p?r[l].push((a={},o=f,i=g(n),o in a?Object.defineProperty(a,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[o]=i,a)):r[l][f]=g(n)}else v([u[1],n],r,!0)}}.apply(void 0,r(e).concat([n])):v(e,n)}),n}function u(t,e){return void 0===t?e?[]:{}:e?t:(r={},i(n=t)&&n.forEach(function(t,e){r[e]=t}),r);var n,r}function w(t,e){return null==(n=t)||i(n)||"[object Object]"!==n.toString()?i(t)||void 0===t?{ob:u(t,o(e))}:{ob:[t],push:null!==t}:{ob:t};var n}function v(t,e,n){var r=d(t,2),a=r[0],o=r[1];o=g(o),a in e?(e[a]=i(e[a])?e[a]:[e[a]],e[a].push(o)):e[a]=n?[o]:o}function g(t){if(null==t)return"";if("string"!=typeof t)return t;if(o(t=t.trim()))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function n(){return e.apply(this,arguments)}return a&&window.jQuery&&(window.jQuery.deparam=n),t&&c.jQuery&&(c.jQuery.deparam=n),n}()}(e={exports:{}},e.exports),e.exports);function i(t){return t instanceof Node||window}function u(t){return"function"==typeof t}var r=function(){function n(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.length=0,(t=i(t)?[t]:t instanceof NodeList||t instanceof HTMLCollection?o(t):"string"==typeof t?o(document.querySelectorAll(t)):Array.isArray(t)?t.map(i):null)&&t.forEach(function(t){e[e.length++]=t})}var t,e,r;return t=n,(e=[{key:"each",value:function(t){for(var e=0;e<this.length;e++)if(u(t)){var n=t(e,this[e],this);if(!0===n)continue;if(!1===n)break}}},{key:"on",value:function(n,r,a){this.each(function(t,e){e.addEventListener(n,function(t){var e=t.detail,n=e&&e.customData?o(e.customData):[];u(r)&&r.apply(this,[event].concat(o(n)))},a)})}},{key:"trigger",value:function(t,e){var n=new CustomEvent(t,{cancelable:!0,bubbles:!0,detail:{customData:e}});this.each(function(t,e){e.dispatchEvent(n)})}}])&&a(t.prototype,e),r&&a(t,r),n}();function l(t){return new r(t)}var f={handlers:[]},p=history&&history.pushState,d={noTrigger:!1},y={pathname:/^\/(?=[^?]*)/,routeparams:/:[^\/]+/g,hashQuery:/\?.+/},w={routeChanged:"routeChanged",hashchange:"hashchange",popstate:"popstate"},v={invalidPath:"Path is invalid"};function g(t){return Array.prototype.slice.call(t)}function m(t){return null!==t&&"object"===s(t)?t:{}}function b(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(d.noTrigger&&e===w.hashchange)d.noTrigger=!1;else{d.data=m(d.data);var r=d.data.data=m(d.data.data),a={eventType:e,hash:!!n,route:t};d.data.data=h({},r,a),E.events.trigger(w.routeChanged,d.data)}}function j(){var t=n(window.location.search),e={};return window.location.hash.match(y.hashQuery)&&(e=n(window.location.hash.match(y.hashQuery)[0])),h({},t,e)}function A(t,e,n){if("string"==typeof(i=t)&&y.pathname.test(i))return r=t,o=n,(a=e)||o?"string"==typeof a?(a=a.trim())&&o?r+window.location.search+"&"+a.replace("?",""):a?r+"?"+a.replace("?",""):r:void 0:r;var r,a,o,i;!function(t){throw new Error(t)}(v.invalidPath)}function O(t){return t.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,"")}function S(t,e,n){if(~e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),y.routeparams.lastIndex=0,!y.routeparams.test(t))return t===e||"*"===t;n.params={};var r=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(r.test(e)){y.routeparams.lastIndex=0;var a=g(t.match(y.routeparams)).map(O),o=g(e.match(r));return o.shift(),a.forEach(function(t,e){n.params[t]=o[e]}),!0}return!1}var E={events:h({},w,{trigger:function(t,e){return function(e,n){(n=m(n)).data=m(n.data);var r=n.data.hash;f.handlers.forEach(function(t){t.eventName===e&&(p&&!r&&S(t.route,window.location.pathname,n)?t.handler(n.data,n.params,j()):r&&(window.location.hash||p||!S(t.route,window.location.pathname,n)?S(t.route,window.location.hash.substring(1),n)&&t.handler(n.data,n.params,j()):(d.data=n.data,window.location.replace("#"+window.location.pathname))))})}.apply(this,[t,e])}}),init:function(){var t={eventType:p?w.popstate:w.hashchange,hash:!p,route:p?window.location.pathname:window.location.hash};this.events.trigger(w.routeChanged,{data:t}),window.location.hash&&l(window).trigger(w.hashchange)},set:function(){return function(t,e,n){if(t){var r=null,a="",o="",i=!1,u=!1,c=e?"replaceState":"pushState";if(d.noTrigger=n,"object"===s(t)?(d.data={data:t.data},r=t.title,a=t.route,o=t.queryString,i=t.appendQuery):"string"==typeof t&&(d.data={data:{}},a=t),"#"===a.charAt(0)&&(u=!0,a=a.replace("#","")),p&&!u){if(history[c](d.data,r,A(a,o,i)),!n){var l={eventType:w.popstate,hash:!1,route:a},f=d.data.data;d.data.data=h({},f,l),E.events.trigger(w.routeChanged,d.data)}}else e?window.location.replace("#"+A(a,o,i)):window.location.hash=A(a,o,i)}}.apply(this,arguments)},historySupported:p};function x(){return function(e,n){var r=this;f.handlers.filter(function(t){return t.originalHandler===n&&t.route===e&&t.element===r}).length||f.handlers.push({eventName:w.routeChanged,originalHandler:n,handler:n.bind(this),element:this,route:e})}.apply(this,arguments)}"function"==typeof jQuery&&jQuery.fn&&(jQuery.route=jQuery.fn.route=x,jQuery.router=E),l(window).on(w.popstate,function(t){b.apply(this,[window.location.pathname,t.type])}),l(window).on(w.hashchange,function(t){b.apply(this,[window.location.hash,t.type,!0])}),t.router=E,t.route=x,Object.defineProperty(t,"__esModule",{value:!0})});
